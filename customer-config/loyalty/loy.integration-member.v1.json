{
  "$id": "loy.integration-member.v1",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "IntegrationTypeMapping",
  "oneOf": [
    {"type": "null"},
    {
      "type": "object",
      "properties": {
        "type": { "const": "http" },
        "config": {
          "type": "object",
          "properties": {
            "url": { "type": "string" },
            "timeout": { "type": "number" }
          },
          "required": ["url", "timeout"],
          "additionalProperties": false
        }
      },
      "required": ["type", "config"],
      "additionalProperties": false
    },
    {
      "type": "object",
      "properties": {
        "type": { "const": "basic" },
        "config": {
          "type": "object",
          "properties": {
            "url": { "type": "string" },
            "timeout": { "type": "number" },
            "username": { "type": "string" },
            "password": { "type": "string" }
          },
          "required": ["url", "timeout", "username", "password"],
          "additionalProperties": false
        }
      },
      "required": ["type", "config"],
      "additionalProperties": false
    },
    {
      "type": "object",
      "properties": {
        "type": { "const": "oauth2" },
        "config": {
          "oneOf": [
            {
              "type": "object",
              "properties": {
                "type": { "const": "client_credentials" },
                "url": { "type": "string" },
                "timeout": { "type": "number" },
                "tokenUrl": { "type": "string" },
                "authTimeout": { "type": "number" },
                "clientId": { "type": "string" },
                "clientSecret": { "type": "string" },
                "scope": { "type": "string" }
              },
              "required": [
                "type",
                "url",
                "timeout",
                "tokenUrl",
                "clientId",
                "clientSecret"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "properties": {
                "type": { "const": "implicit" },
                "url": { "type": "string" },
                "timeout": { "type": "number" },
                "tokenUrl": { "type": "string" },
                "authTimeout": { "type": "number" },
                "clientId": { "type": "string" },
                "accessToken": { "type": "string" },
                "tokenType": { "type": "string" },
                "scope": { "type": "string" }
              },
              "required": [
                "type",
                "url",
                "timeout",
                "tokenUrl",
                "clientId",
                "accessToken",
                "tokenType"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "properties": {
                "type": { "const": "password" },
                "url": { "type": "string" },
                "timeout": { "type": "number" },
                "tokenUrl": { "type": "string" },
                "authTimeout": { "type": "number" },
                "clientId": { "type": "string" },
                "userName": { "type": "string" },
                "password": { "type": "string" },
                "scope": { "type": "string" }
              },
              "required": [
                "type",
                "url",
                "timeout",
                "tokenUrl",
                "clientId",
                "userName",
                "password"
              ],
              "additionalProperties": false
            }
          ]
        }
      },
      "required": ["type", "config"],
      "additionalProperties": false
    },
    {
      "type": "object",
      "properties": {
        "type": { "const": "certificate" },
        "config": {
          "type": "object",
          "properties": {
            "url": { "type": "string" },
            "timeout": { "type": "number" },
            "certificate": {
              "anyOf": [{ "type": "string" }, { "type": "object" }]
            },
            "privateKey": {
              "anyOf": [{ "type": "string" }, { "type": "object" }]
            },
            "passphrase": { "type": "string" }
          },
          "required": ["url", "timeout", "privateKey"],
          "additionalProperties": false
        }
      },
      "required": ["type", "config"],
      "additionalProperties": false
    },
    {
      "type": "object",
      "properties": {
        "type": { "const": "basic:certificate" },
        "config": {
          "type": "object",
          "properties": {
            "url": { "type": "string" },
            "timeout": { "type": "number" },
            "username": { "type": "string" },
            "password": { "type": "string" },
            "certificate": {
              "anyOf": [{ "type": "string" }, { "type": "object" }]
            },
            "privateKey": {
              "anyOf": [{ "type": "string" }, { "type": "object" }]
            },
            "passphrase": { "type": "string" }
          },
          "required": ["url", "timeout", "username", "password", "privateKey"],
          "additionalProperties": false
        }
      },
      "required": ["type", "config"],
      "additionalProperties": false
    },
    {
      "type": "object",
      "properties": {
        "type": { "const": "oauth2:certificate" },
        "config": {
          "allOf": [
            {
              "oneOf": [
                {
                  "type": "object",
                  "properties": {
                    "type": { "const": "client_credentials" },
                    "clientSecret": { "type": "string" }
                  },
                  "required": ["type", "clientSecret"]
                },
                {
                  "type": "object",
                  "properties": {
                    "type": { "const": "implicit" },
                    "accessToken": { "type": "string" },
                    "tokenType": { "type": "string" }
                  },
                  "required": ["type", "accessToken", "tokenType"]
                },
                {
                  "type": "object",
                  "properties": {
                    "type": { "const": "password" },
                    "userName": { "type": "string" },
                    "password": { "type": "string" }
                  },
                  "required": ["type", "userName", "password"]
                }
              ]
            },
            {
              "type": "object",
              "properties": {
                "url": { "type": "string" },
                "timeout": { "type": "number" },
                "tokenUrl": { "type": "string" },
                "authTimeout": { "type": "number" },
                "clientId": { "type": "string" },
                "scope": { "type": "string" },
                "certificate": {
                  "anyOf": [{ "type": "string" }, { "type": "object" }]
                },
                "privateKey": {
                  "anyOf": [{ "type": "string" }, { "type": "object" }]
                },
                "passphrase": { "type": "string" }
              },
              "required": [
                "url",
                "timeout",
                "tokenUrl",
                "clientId",
                "privateKey"
              ]
            }
          ]
        }
      },
      "required": ["type", "config"],
      "additionalProperties": false
    }
  ]
}
